{
  "metadata": {
    "version": "1.0.0",
    "last_updated": "2024-12-01",
    "description": "테이블 간 관계 매핑 및 분석적 조인 패턴 정의",
    "purpose": "Enhanced RAG 시스템의 스키마 검색을 위한 관계형 데이터"
  },
  "entity_relationships": {
    "primary_entities": {
      "customers": {
        "description": "고객 기본 정보",
        "primary_key": "customer_id",
        "related_tables": ["sales_performance", "customer_satisfaction"],
        "business_significance": "고객 중심 분석의 핵심 엔티티"
      },
      "employees": {
        "description": "직원 정보",
        "primary_key": "employee_id",
        "related_tables": ["sales_performance"],
        "business_significance": "인사 및 성과 분석"
      },
      "products": {
        "description": "제품 정보",
        "primary_key": "product_id", 
        "related_tables": ["sales_performance"],
        "business_significance": "제품 성과 및 포트폴리오 분석"
      },
      "courses": {
        "description": "교육 과정 정보",
        "primary_key": "course_id",
        "related_tables": ["student_performance"],
        "business_significance": "교육 효과성 분석"
      }
    },
    "fact_tables": {
      "sales_performance": {
        "type": "transactional_fact",
        "grain": "개별 매출 거래",
        "foreign_keys": {
          "customer_id": "customers.customer_id",
          "salesperson_id": "employees.employee_id",
          "product_id": "products.product_id"
        },
        "measures": ["sales_amount"],
        "dimensions": ["region", "product_category", "customer_segment", "sales_date"]
      },
      "customer_satisfaction": {
        "type": "survey_fact",
        "grain": "개별 설문 응답",
        "foreign_keys": {
          "customer_id": "customers.customer_id"
        },
        "measures": ["satisfaction_score", "service_quality", "recommendation_score"],
        "dimensions": ["channel", "age_group", "survey_date"]
      },
      "marketing_campaign": {
        "type": "behavioral_fact",
        "grain": "개별 캠페인 참여",
        "foreign_keys": {
          "user_id": "customers.customer_id"
        },
        "measures": ["exposure_time"],
        "dimensions": ["campaign_type", "test_group", "device_type", "campaign_date"],
        "flags": ["conversion", "click_through"]
      },
      "student_performance": {
        "type": "educational_fact",
        "grain": "학생별 과목별 성과",
        "foreign_keys": {
          "course_id": "courses.course_id"
        },
        "measures": ["pre_test_score", "post_test_score", "attendance_rate", "study_hours"],
        "dimensions": ["grade_level", "learning_method", "gender"]
      },
      "financial_performance": {
        "type": "financial_fact",
        "grain": "사업부별 분기별 성과",
        "measures": ["revenue", "operating_cost", "profit_margin", "investment_amount", "roi"],
        "dimensions": ["business_unit", "quarter"]
      }
    }
  },
  "analytical_join_patterns": {
    "customer_360": {
      "description": "고객 360도 뷰 - 매출과 만족도 통합 분석",
      "purpose": "고객 가치와 만족도 상관관계 분석",
      "tables": ["customers", "sales_performance", "customer_satisfaction"],
      "join_logic": [
        "customers.customer_id = sales_performance.customer_id",
        "customers.customer_id = customer_satisfaction.customer_id"
      ],
      "analysis_types": [
        "고객 세그먼트별 매출-만족도 상관분석",
        "고가치 고객의 만족도 패턴 분석",
        "만족도가 재구매에 미치는 영향"
      ],
      "statistical_methods": ["correlation", "regression", "segmentation"],
      "business_questions": [
        "만족도가 높은 고객의 평균 구매 금액은?",
        "어떤 지역의 고객이 가장 만족도가 높은가?",
        "고객 세그먼트별 만족도 차이가 있는가?"
      ]
    },
    "marketing_effectiveness": {
      "description": "마케팅 캠페인 효과성 분석",
      "purpose": "캠페인 성과와 실제 매출 연결 분석",
      "tables": ["marketing_campaign", "sales_performance"],
      "join_logic": [
        "marketing_campaign.user_id = sales_performance.customer_id"
      ],
      "time_consideration": "캠페인 날짜 이후 30일 내 매출",
      "analysis_types": [
        "A/B 테스트 그룹별 매출 차이",
        "캠페인 유형별 ROI 분석",
        "전환율과 실제 구매 금액 상관관계"
      ],
      "statistical_methods": ["A/B_testing", "causal_inference", "cohort_analysis"],
      "business_questions": [
        "어떤 캠페인 유형이 가장 높은 매출을 가져오는가?",
        "A/B 테스트 결과 실제 매출에 유의한 차이가 있는가?",
        "디바이스별 캠페인 효과 차이는?"
      ]
    },
    "employee_performance": {
      "description": "직원 성과 분석",
      "purpose": "개별 영업사원의 성과 및 영향 요인 분석",
      "tables": ["employees", "sales_performance"],
      "join_logic": [
        "employees.employee_id = sales_performance.salesperson_id"
      ],
      "analysis_types": [
        "영업사원별 매출 성과 비교",
        "지역별 영업 효율성 분석",
        "개인 성과 영향 요인 분석"
      ],
      "statistical_methods": ["ANOVA", "regression", "hierarchical_modeling"],
      "business_questions": [
        "영업사원 간 성과 차이가 통계적으로 유의한가?",
        "어떤 요인이 영업 성과에 가장 큰 영향을 미치는가?",
        "지역별로 영업사원 성과 패턴이 다른가?"
      ]
    },
    "educational_effectiveness": {
      "description": "교육 프로그램 효과성 분석",
      "purpose": "교육 방법론별 학습 성과 비교",
      "tables": ["courses", "student_performance"],
      "join_logic": [
        "courses.course_id = student_performance.course_id"
      ],
      "analysis_types": [
        "사전-사후 점수 개선도 분석",
        "교육 방법별 효과 비교",
        "학습자 특성별 성과 차이"
      ],
      "statistical_methods": ["paired_t_test", "ANOVA", "mixed_effects"],
      "business_questions": [
        "교육 프로그램이 실제로 학습 성과를 향상시키는가?",
        "어떤 교육 방법이 가장 효과적인가?",
        "학습자 특성에 따라 적합한 교육 방법이 다른가?"
      ]
    },
    "cross_functional_analysis": {
      "description": "부서간 협업 효과 분석",
      "purpose": "마케팅-영업-고객만족도 통합 분석",
      "tables": ["marketing_campaign", "sales_performance", "customer_satisfaction"],
      "join_logic": [
        "marketing_campaign.user_id = sales_performance.customer_id",
        "sales_performance.customer_id = customer_satisfaction.customer_id"
      ],
      "analysis_types": [
        "마케팅→매출→만족도 연쇄 효과 분석",
        "통합 고객 여정 분석",
        "부서별 기여도 분석"
      ],
      "statistical_methods": ["path_analysis", "structural_equation", "mediation"],
      "business_questions": [
        "마케팅 캠페인이 매출을 통해 만족도에 미치는 간접 효과는?",
        "고객 여정 전 단계에서 어느 부분이 가장 중요한가?",
        "마케팅 효과가 만족도로 이어지는 메커니즘은?"
      ]
    }
  },
  "temporal_relationships": {
    "time_based_joins": {
      "campaign_to_sales": {
        "description": "캠페인 노출 후 구매까지의 시간 고려",
        "time_window": "캠페인 날짜 + 30일",
        "join_condition": "campaign_date <= sales_date <= campaign_date + INTERVAL 30 DAY"
      },
      "satisfaction_survey_timing": {
        "description": "구매 후 만족도 조사 시점",
        "time_window": "구매 날짜 + 7일",
        "join_condition": "sales_date <= survey_date <= sales_date + INTERVAL 7 DAY"
      },
      "quarterly_financial": {
        "description": "분기별 재무 성과 집계",
        "aggregation_level": "quarter",
        "time_grouping": "YEAR(date), QUARTER(date)"
      }
    },
    "lag_considerations": {
      "marketing_impact": "캠페인 효과는 즉시~30일 후까지 지속",
      "satisfaction_feedback": "구매 후 1주일 내 설문 응답이 가장 정확",
      "educational_outcome": "교육 완료 후 즉시 측정되는 사후 점수"
    }
  },
  "data_integration_patterns": {
    "aggregation_strategies": {
      "customer_level": {
        "description": "고객별 집계 지표 생성",
        "metrics": [
          "total_sales_amount",
          "average_satisfaction_score", 
          "campaign_response_rate",
          "purchase_frequency"
        ],
        "time_period": "최근 12개월"
      },
      "regional_level": {
        "description": "지역별 성과 지표",
        "metrics": [
          "regional_sales_total",
          "regional_satisfaction_avg",
          "market_penetration_rate"
        ],
        "grouping": "region"
      },
      "temporal_aggregation": {
        "daily": "일별 매출, 캠페인 성과",
        "weekly": "주별 트렌드 분석",
        "monthly": "월별 성과 리포트",
        "quarterly": "분기별 재무 성과"
      }
    },
    "normalization_requirements": {
      "score_standardization": "서로 다른 척도의 점수를 0-1로 정규화",
      "currency_adjustment": "물가 상승률 고려한 매출 조정",
      "seasonal_adjustment": "계절성 보정된 성과 지표"
    }
  },
  "analytical_constraints": {
    "data_quality_requirements": {
      "minimum_sample_size": {
        "t_test": "각 그룹 최소 30개",
        "ANOVA": "각 그룹 최소 15개",
        "regression": "변수당 최소 10개",
        "correlation": "최소 20개 쌍"
      },
      "completeness_threshold": {
        "critical_analysis": "95% 이상 완전성 필요",
        "exploratory_analysis": "80% 이상 완전성 허용"
      }
    },
    "business_rules": {
      "valid_date_ranges": {
        "sales_data": "2020-01-01 이후",
        "satisfaction_surveys": "2021-01-01 이후",
        "marketing_campaigns": "2021-06-01 이후"
      },
      "logical_constraints": [
        "sales_amount > 0",
        "satisfaction_score BETWEEN 1 AND 5",
        "pre_test_score <= post_test_score (일반적 기대)",
        "survey_date >= sales_date (순서 관계)"
      ]
    }
  },
  "recommended_analysis_workflows": {
    "customer_analysis_flow": [
      "1. 고객 기본 통계량 확인",
      "2. 매출-만족도 상관관계 분석",
      "3. 세그먼트별 차이 검정",
      "4. 예측 모델링",
      "5. 비즈니스 인사이트 도출"
    ],
    "campaign_analysis_flow": [
      "1. A/B 테스트 그룹 균형성 확인",
      "2. 전환율 차이 검정",
      "3. 매출 영향 분석",
      "4. ROI 계산",
      "5. 최적 캠페인 전략 도출"
    ],
    "educational_analysis_flow": [
      "1. 사전 점수 그룹 간 동질성 확인",
      "2. 사전-사후 점수 차이 검정",
      "3. 교육 방법별 효과 비교",
      "4. 영향 요인 분석",
      "5. 교육 개선 방안 제시"
    ]
  }
} 