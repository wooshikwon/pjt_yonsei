{
  "natural_language_request_analysis": {
    "system_prompt": "ë‹¹ì‹ ì€ Enhanced RAG ì‹œìŠ¤í…œì„ í™œìš©í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸ ì¸ì‹ í†µê³„ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ìì—°ì–´ ìš”ì²­ì„ ì •í™•íˆ íŒŒì‹±í•˜ê³ , ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ì§€ì‹ê³¼ DB ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ì¢…í•©í•˜ì—¬ ìµœì ì˜ í†µê³„ ë¶„ì„ ë°©ë²•ì„ ì¶”ì²œí•©ë‹ˆë‹¤.",
    "user_prompt_template": "ğŸ” **ìì—°ì–´ ë¶„ì„ ìš”ì²­ ì²˜ë¦¬** (workflow_node: natural_language_request)\n\n**ì‚¬ìš©ì ìš”ì²­:** {natural_language_request}\n\n**ë°ì´í„° ì»¨í…ìŠ¤íŠ¸:**\n- ë°ì´í„°ì…‹: {dataset_name}\n- í–‰ ìˆ˜: {num_rows}í–‰\n- ì»¬ëŸ¼ ìˆ˜: {num_columns}ê°œ\n- ì£¼ìš” ì»¬ëŸ¼: {key_columns}\n- ë°ì´í„° íƒ€ì…: {column_types}\n\n**Enhanced RAG ê²€ìƒ‰ ê²°ê³¼:**\n\n**ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸:**\n{business_context}\n\n**ğŸ—„ï¸ DB ìŠ¤í‚¤ë§ˆ ì»¨í…ìŠ¤íŠ¸:**\n{schema_context}\n\n**ğŸ“Š í†µê³„ ì§€ì‹ ì»¨í…ìŠ¤íŠ¸:**\n{statistical_knowledge}\n\n**ë¶„ì„ ìš”ì²­ì‚¬í•­:**\n1. ì‚¬ìš©ìì˜ ìì—°ì–´ ìš”ì²­ì„ ì •í™•íˆ íŒŒì‹±í•˜ì—¬ ë¶„ì„ ëª©ì ê³¼ ëŒ€ìƒ ë³€ìˆ˜ë¥¼ ì‹ë³„í•˜ì„¸ìš”\n2. ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸ë¥¼ ê³ ë ¤í•˜ì—¬ ë„ë©”ì¸ íŠ¹í™” í•´ì„ì„ ì œê³µí•˜ì„¸ìš”\n3. DB ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ í™œìš©í•˜ì—¬ ë°ì´í„° êµ¬ì¡°ì  ì œì•½ì‚¬í•­ì„ ê³ ë ¤í•˜ì„¸ìš”\n4. ë°ì´í„° ì»¬ëŸ¼ê³¼ ìš”ì²­ ë‚´ìš©ì˜ ë§¤ì¹­ ê°€ëŠ¥ì„±ì„ í™•ì¸í•˜ì„¸ìš”\n5. ë¶„ì„ ìš”ì²­ì´ ë¶ˆëª…í™•í•œ ê²½ìš° ëª…í™•í™” ì§ˆë¬¸ì„ ìƒì„±í•˜ì„¸ìš”\n\n**ì‘ë‹µ í˜•ì‹:**\n```json\n{\n  \"request_analysis\": {\n    \"parsed_request\": \"íŒŒì‹±ëœ ìš”ì²­ ë‚´ìš©\",\n    \"analysis_type\": \"ê¸°ìˆ í†µê³„|ìƒê´€ë¶„ì„|ê·¸ë£¹ë¹„êµ|íšŒê·€ë¶„ì„|ë²”ì£¼ë¶„ì„|ê¸°íƒ€\",\n    \"business_objective\": \"ë¹„ì¦ˆë‹ˆìŠ¤ ëª©ì \",\n    \"target_variables\": {\n      \"dependent\": [\"ì¢…ì†ë³€ìˆ˜ë“¤\"],\n      \"independent\": [\"ë…ë¦½ë³€ìˆ˜ë“¤\"],\n      \"grouping\": [\"ê·¸ë£¹í™” ë³€ìˆ˜ë“¤\"]\n    },\n    \"column_mapping\": {\n      \"matched_columns\": [\"ë§¤ì¹­ëœ ì»¬ëŸ¼ë“¤\"],\n      \"missing_columns\": [\"ëˆ„ë½ëœ ì»¬ëŸ¼ë“¤\"]\n    }\n  },\n  \"clarity_assessment\": {\n    \"is_clear\": true,\n    \"clarity_score\": 0.8,\n    \"unclear_aspects\": [\"ë¶ˆëª…í™•í•œ ë¶€ë¶„ë“¤\"]\n  },\n  \"clarification_questions\": [\n    {\n      \"question\": \"ëª…í™•í™” ì§ˆë¬¸\",\n      \"reason\": \"ì§ˆë¬¸ ì´ìœ \",\n      \"suggested_answers\": [\"ì œì•ˆ ë‹µë³€ë“¤\"]\n    }\n  ],\n  \"preliminary_recommendations\": [\n    {\n      \"method_name\": \"í†µê³„ ë°©ë²•ëª…\",\n      \"confidence\": 0.9,\n      \"rationale\": \"ì¶”ì²œ ì´ìœ \",\n      \"data_requirements\": [\"ë°ì´í„° ìš”êµ¬ì‚¬í•­ë“¤\"]\n    }\n  ]\n}\n```",
    "examples": [
      {
        "request": "ì§€ì—­ë³„ ë§¤ì¶œ ì°¨ì´ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œì§€ í™•ì¸í•˜ê³  ì‹¶ì–´ìš”",
        "context": "sales_performance.csv, ì˜ì—…/ë¦¬í…Œì¼ ë„ë©”ì¸, region/sales_amount ì»¬ëŸ¼",
        "expected_output": "ì¼ì›ë¶„ì‚°ë¶„ì„(ANOVA) ì¶”ì²œ, ì§€ì—­ë³„ ì„¸ê·¸ë¨¼í…Œì´ì…˜ ë¶„ì„"
      },
      {
        "request": "ê³ ê° ë§Œì¡±ë„ì— ì˜í–¥ì„ ì£¼ëŠ” ìš”ì¸ë“¤ì„ ë¶„ì„í•´ì£¼ì„¸ìš”",
        "context": "customer_survey.csv, ê³ ê°ê´€ë¦¬ ë„ë©”ì¸, satisfaction_score ë“±",
        "expected_output": "ë‹¤ì¤‘íšŒê·€ë¶„ì„ ì¶”ì²œ, ì˜ˆì¸¡ëª¨ë¸ êµ¬ì¶•"
      }
    ]
  },

  "request_clarification": {
    "system_prompt": "ë‹¹ì‹ ì€ ì‚¬ìš©ìì˜ ë¶ˆëª…í™•í•œ ë¶„ì„ ìš”ì²­ì„ ëª…í™•í™”í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸ì™€ ë°ì´í„° êµ¬ì¡°ë¥¼ ê³ ë ¤í•˜ì—¬ êµ¬ì²´ì ì´ê³  ë„ì›€ì´ ë˜ëŠ” ì§ˆë¬¸ì„ ìƒì„±í•©ë‹ˆë‹¤.",
    "user_prompt_template": "â“ **ìš”ì²­ ëª…í™•í™”** (workflow_node: request_clarification)\n\n**ì›ë³¸ ìš”ì²­:** {original_request}\n**ë¶ˆëª…í™•í•œ ë¶€ë¶„:** {unclear_aspects}\n\n**ë°ì´í„° ì •ë³´:**\n- ì‚¬ìš© ê°€ëŠ¥í•œ ì»¬ëŸ¼: {available_columns}\n- ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸: {business_domain}\n- ìŠ¤í‚¤ë§ˆ ì œì•½ì‚¬í•­: {schema_constraints}\n\n**ëª…í™•í™” ì „ëµ:**\n1. êµ¬ì²´ì ì´ê³  ì„ íƒì§€ê°€ ìˆëŠ” ì§ˆë¬¸ì„ ìƒì„±í•˜ì„¸ìš”\n2. ë¹„ì¦ˆë‹ˆìŠ¤ ë§¥ë½ì—ì„œ ì´í•´í•˜ê¸° ì‰¬ìš´ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”\n3. ë°ì´í„° êµ¬ì¡°ë¥¼ ê³ ë ¤í•œ ì‹¤í˜„ ê°€ëŠ¥í•œ ì˜µì…˜ì„ ì œì‹œí•˜ì„¸ìš”\n4. ì‚¬ìš©ìì˜ ë¶„ì„ ëª©ì ì„ ë” ëª…í™•íˆ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ì§ˆë¬¸ì„ í¬í•¨í•˜ì„¸ìš”\n\n**ì‘ë‹µ í˜•ì‹:**\n```json\n{\n  \"clarification_questions\": [\n    {\n      \"category\": \"ë¶„ì„ëª©ì |ë³€ìˆ˜ì„ íƒ|ê·¸ë£¹í™”|ë¹„êµê¸°ì¤€\",\n      \"question\": \"ëª…í™•í•˜ê³  êµ¬ì²´ì ì¸ ì§ˆë¬¸\",\n      \"options\": [\"ì„ íƒì§€1\", \"ì„ íƒì§€2\", \"ì„ íƒì§€3\"],\n      \"default_suggestion\": \"ê¶Œì¥ ì„ íƒì§€\",\n      \"business_context\": \"ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œì˜ ì„¤ëª…\"\n    }\n  ],\n  \"suggested_refinements\": [\n    {\n      \"refined_request\": \"ê°œì„ ëœ ìš”ì²­ ì˜ˆì‹œ\",\n      \"why_better\": \"ê°œì„  ì´ìœ \"\n    }\n  ]\n}\n```",
    "clarification_strategies": [
      "ë¶„ì„ ëª©ì  êµ¬ì²´í™” (íƒìƒ‰ì  vs í™•ì¦ì )",
      "ë¹„êµ ëŒ€ìƒ ëª…í™•í™” (ê·¸ë£¹, ì‹œì , ì¡°ê±´)",
      "ì¸¡ì • ì§€í‘œ ì„ íƒ (í‰ê· , ë¹„ìœ¨, ë¶„í¬)",
      "ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì‚¬ê²°ì • ì—°ê²°"
    ]
  },

  "ai_recommendation_generation": {
    "system_prompt": "ë‹¹ì‹ ì€ Enhanced RAG ì‹œìŠ¤í…œì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨í…ìŠ¤íŠ¸ì™€ DB ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ì¢…í•©í•˜ì—¬ ìµœì ì˜ í†µê³„ ë¶„ì„ ë°©ë²•ì„ ì¶”ì²œí•˜ëŠ” AI ì „ë¬¸ê°€ì…ë‹ˆë‹¤. workflow_graph.jsonì˜ ai_recommendation_generation ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.",
    "user_prompt_template": "ğŸ§  **AI ë¶„ì„ ë°©ë²• ì¶”ì²œ ìƒì„±** (workflow_node: ai_recommendation_generation)\n\n**ë¶„ì„ ì»¨í…ìŠ¤íŠ¸:**\n- ëª…í™•í™”ëœ ìš”ì²­: {clarified_request}\n- ë¶„ì„ ìœ í˜•: {analysis_type}\n- ëŒ€ìƒ ë³€ìˆ˜: {target_variables}\n- ë°ì´í„° íŠ¹ì„±: {data_characteristics}\n\n**Enhanced RAG ì»¨í…ìŠ¤íŠ¸:**\n**ë¹„ì¦ˆë‹ˆìŠ¤ ì§€ì‹:** {business_knowledge}\n**ìŠ¤í‚¤ë§ˆ ì •ë³´:** {schema_info}\n**í†µê³„ ë°©ë²•ë¡ :** {statistical_methods}\n\n**ë°ì´í„° í’ˆì§ˆ ì •ë³´:**\n- ê²°ì¸¡ì¹˜ ë¹„ìœ¨: {missing_rate}\n- ì´ìƒì¹˜ íƒì§€ ê²°ê³¼: {outlier_info}\n- ë°ì´í„° ë¶„í¬: {distribution_info}\n\n**ì¶”ì²œ ê¸°ì¤€ (ê°€ì¤‘ì¹˜):**\n1. ë¹„ì¦ˆë‹ˆìŠ¤ ëª©ì  ì í•©ì„± (40%)\n2. ë°ì´í„° íŠ¹ì„± ì¼ì¹˜ì„± (30%)\n3. í†µê³„ì  ì—„ë°€ì„± (20%)\n4. í•´ì„ ìš©ì´ì„± (10%)\n\n**ìš”êµ¬ì‚¬í•­:**\n- ì¶”ì²œë„ 95% ì´ìƒì¸ ì£¼ ë°©ë²• 1ê°œ í•„ìˆ˜\n- ì¶”ì²œë„ 80% ì´ìƒì¸ ëŒ€ì•ˆ ë°©ë²• 1-2ê°œ\n- ê° ë°©ë²•ë³„ ìƒì„¸í•œ ì ìš© ê·¼ê±°ì™€ ì „ì œì¡°ê±´\n- ë¹„ì¦ˆë‹ˆìŠ¤ í•´ì„ ê°€ì´ë“œë¼ì¸\n- DB ìŠ¤í‚¤ë§ˆ ì œì•½ì¡°ê±´ ë°˜ì˜\n\n**ì‘ë‹µ í˜•ì‹:**\n```json\n{\n  \"primary_recommendation\": {\n    \"method_name\": \"í†µê³„ ë°©ë²•ëª…\",\n    \"method_category\": \"descriptive|inferential|predictive\",\n    \"confidence_score\": 0.95,\n    \"business_rationale\": \"ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì  ì¶”ì²œ ì´ìœ \",\n    \"statistical_rationale\": \"í†µê³„í•™ì  ì¶”ì²œ ì´ìœ \",\n    \"schema_compatibility\": \"ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ì„¤ëª…\",\n    \"assumptions\": [\n      {\n        \"assumption\": \"ê°€ì •ëª…\",\n        \"check_method\": \"ê²€ì •ë°©ë²•\",\n        \"violation_alternative\": \"ìœ„ë°˜ì‹œ ëŒ€ì•ˆ\"\n      }\n    ],\n    \"expected_outputs\": [\"ì˜ˆìƒ ê²°ê³¼ë¬¼ë“¤\"],\n    \"business_interpretation_guide\": \"ê²°ê³¼ í•´ì„ ê°€ì´ë“œ\"\n  },\n  \"alternative_recommendations\": [\n    {\n      \"method_name\": \"ëŒ€ì•ˆ ë°©ë²•ëª…\",\n      \"confidence_score\": 0.85,\n      \"when_to_use\": \"ì‚¬ìš© ì¡°ê±´\",\n      \"pros_cons\": {\n        \"pros\": [\"ì¥ì ë“¤\"],\n        \"cons\": [\"ë‹¨ì ë“¤\"]\n      }\n    }\n  ],\n  \"preprocessing_requirements\": [\n    {\n      \"step\": \"ì „ì²˜ë¦¬ ë‹¨ê³„\",\n      \"description\": \"ìƒì„¸ ì„¤ëª…\",\n      \"code_snippet\": \"Python ì½”ë“œ ì˜ˆì‹œ\"\n    }\n  ],\n  \"risk_assessments\": [\n    {\n      \"risk\": \"ìœ„í—˜ ìš”ì†Œ\",\n      \"probability\": \"high|medium|low\",\n      \"mitigation\": \"ì™„í™” ë°©ì•ˆ\"\n    }\n  ]\n}\n```",
    "recommendation_matrix": {
      "group_comparison": ["t-test", "ANOVA", "Mann-Whitney", "Kruskal-Wallis"],
      "correlation": ["Pearson", "Spearman", "Kendall"],
      "regression": ["Linear", "Logistic", "Polynomial", "Ridge"],
      "categorical": ["Chi-square", "Fisher", "McNemar"]
    }
  }
} 