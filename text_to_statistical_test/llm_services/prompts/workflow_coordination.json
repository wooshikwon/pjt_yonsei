{
  "workflow_management": {
    "system_prompt": "당신은 Enhanced RAG 기반 통계 분석 워크플로우를 조정하고 관리하는 전문가입니다. workflow_graph.json에 정의된 15개 노드 간의 흐름을 제어하며, 각 단계의 입출력과 상태 전환을 관리합니다.",
    "user_prompt_template": "🔄 **워크플로우 조정 및 상태 관리** (workflow_node: workflow_coordination)\n\n**현재 워크플로우 상태:**\n- 현재 노드: {current_node}\n- 이전 노드: {previous_node}\n- 다음 노드 후보: {next_node_candidates}\n- 전체 진행률: {progress_percentage}%\n\n**이전 단계 결과:**\n{previous_step_results}\n\n**현재 컨텍스트:**\n- 분석 요청: {analysis_request}\n- 데이터 상태: {data_status}\n- 선택된 방법: {selected_method}\n- RAG 컨텍스트: {rag_context}\n\n**워크플로우 조정 요구사항:**\n1. 현재 단계 완료 상태 검증\n2. 다음 단계 진행 조건 확인\n3. 필요시 이전 단계 재실행 판단\n4. 컨텍스트 정보 전달 관리\n5. 오류 상황 처리 및 복구 전략\n\n**응답 형식:**\n```json\n{\n  \"workflow_decision\": {\n    \"current_step_status\": \"completed|in_progress|failed|needs_retry\",\n    \"next_step_recommendation\": \"다음 단계 노드명\",\n    \"transition_conditions_met\": true/false,\n    \"required_prerequisites\": [\"필요한 전제조건들\"],\n    \"context_to_pass\": {\n      \"data_context\": \"데이터 관련 컨텍스트\",\n      \"analysis_context\": \"분석 관련 컨텍스트\",\n      \"business_context\": \"비즈니스 관련 컨텍스트\"\n    }\n  },\n  \"step_validation\": {\n    \"input_validation\": {\n      \"required_inputs_present\": true/false,\n      \"data_quality_acceptable\": true/false,\n      \"context_sufficient\": true/false\n    },\n    \"output_validation\": {\n      \"results_complete\": true/false,\n      \"quality_standards_met\": true/false,\n      \"next_step_ready\": true/false\n    }\n  },\n  \"error_handling\": {\n    \"detected_issues\": [\"발견된 문제들\"],\n    \"severity_levels\": [\"low|medium|high\"],\n    \"recovery_actions\": [\"복구 액션들\"],\n    \"fallback_strategies\": [\"대안 전략들\"]\n  },\n  \"workflow_recommendations\": {\n    \"optimization_suggestions\": [\"최적화 제안들\"],\n    \"parallel_execution_opportunities\": [\"병렬 실행 기회들\"],\n    \"skip_conditions\": [\"건너뛰기 조건들\"],\n    \"early_termination_triggers\": [\"조기 종료 트리거들\"]\n  }\n}\n```",
    "node_transitions": {
      "natural_language_request -> request_clarification": {
        "condition": "요청이 모호하거나 불완전한 경우",
        "context_passing": ["사용자 요청", "초기 파싱 결과"]
      },
      "natural_language_request -> rag_search": {
        "condition": "요청이 명확하고 구체적인 경우",
        "context_passing": ["파싱된 요청", "키워드 추출 결과"]
      },
      "rag_search -> ai_recommendation_generation": {
        "condition": "RAG 검색 결과가 충분한 경우",
        "context_passing": ["검색 결과", "관련 컨텍스트"]
      },
      "ai_recommendation_generation -> user_decision": {
        "condition": "복수 방법 추천시 사용자 선택 필요",
        "context_passing": ["추천 방법들", "각 방법의 장단점"]
      },
      "user_decision -> automated_preprocessing": {
        "condition": "방법이 확정된 경우",
        "context_passing": ["선택된 방법", "데이터 정보"]
      }
    }
  },

  "decision_engine": {
    "system_prompt": "당신은 워크플로우의 각 지점에서 최적의 의사결정을 내리는 엔진입니다. Enhanced RAG 컨텍스트와 분석 요구사항을 종합하여 다음 단계를 결정합니다.",
    "user_prompt_template": "🎯 **워크플로우 의사결정 엔진** (workflow_node: decision_point)\n\n**의사결정 상황:**\n- 결정 지점: {decision_point}\n- 이용 가능한 옵션: {available_options}\n- 선택 기준: {selection_criteria}\n\n**평가 컨텍스트:**\n**📊 분석 요구사항:**\n{analysis_requirements}\n\n**🏢 비즈니스 제약사항:**\n{business_constraints}\n\n**💾 데이터 특성:**\n{data_characteristics}\n\n**🔍 RAG 검색 결과:**\n{rag_insights}\n\n**의사결정 요구사항:**\n1. 각 옵션의 적합성 평가\n2. 리스크 및 제약사항 고려\n3. 최적화된 선택 추천\n4. 선택 근거 제시\n5. 대안 옵션 백업 계획\n\n**응답 형식:**\n```json\n{\n  \"decision_analysis\": {\n    \"options_evaluation\": [\n      {\n        \"option\": \"옵션명\",\n        \"suitability_score\": 0.0-1.0,\n        \"pros\": [\"장점들\"],\n        \"cons\": [\"단점들\"],\n        \"risk_level\": \"low|medium|high\",\n        \"resource_requirement\": \"적음|보통|많음\"\n      }\n    ],\n    \"selection_criteria_weights\": {\n      \"accuracy\": 0.3,\n      \"efficiency\": 0.2,\n      \"interpretability\": 0.2,\n      \"business_alignment\": 0.3\n    }\n  },\n  \"recommended_decision\": {\n    \"primary_choice\": \"주 선택\",\n    \"confidence_level\": 0.0-1.0,\n    \"selection_rationale\": \"선택 근거\",\n    \"expected_outcomes\": [\"예상 결과들\"],\n    \"success_metrics\": [\"성공 지표들\"]\n  },\n  \"contingency_planning\": {\n    \"backup_options\": [\"대안 선택들\"],\n    \"failure_scenarios\": [\"실패 시나리오들\"],\n    \"mitigation_strategies\": [\"완화 전략들\"],\n    \"rollback_procedures\": [\"롤백 절차들\"]\n  },\n  \"implementation_guidance\": {\n    \"execution_steps\": [\"실행 단계들\"],\n    \"monitoring_points\": [\"모니터링 포인트들\"],\n    \"quality_checkpoints\": [\"품질 체크포인트들\"],\n    \"escalation_triggers\": [\"에스컬레이션 트리거들\"]\n  }\n}\n```",
    "decision_types": {
      "method_selection": "통계 방법 선택",
      "data_preprocessing": "전처리 방법 결정",
      "assumption_handling": "가정 위반시 대응",
      "result_interpretation": "결과 해석 방향",
      "report_format": "보고서 형식 선택"
    }
  },

  "context_management": {
    "system_prompt": "당신은 워크플로우 전반에 걸쳐 컨텍스트 정보를 관리하고 전달하는 전문가입니다. Enhanced RAG 시스템과 연동하여 각 단계에서 필요한 정보를 적절히 제공합니다.",
    "user_prompt_template": "🗃️ **컨텍스트 관리 및 정보 전달** (workflow_node: context_management)\n\n**현재 컨텍스트 상태:**\n{current_context_state}\n\n**요청된 컨텍스트 타입:**\n- 비즈니스 컨텍스트: {business_context_needed}\n- 기술적 컨텍스트: {technical_context_needed}\n- 데이터 컨텍스트: {data_context_needed}\n- 분석 컨텍스트: {analysis_context_needed}\n\n**컨텍스트 소스:**\n- RAG 비즈니스 검색기: {business_retriever_results}\n- RAG 스키마 검색기: {schema_retriever_results}\n- 워크플로우 히스토리: {workflow_history}\n- 사용자 인터랙션: {user_interactions}\n\n**컨텍스트 관리 요구사항:**\n1. 관련 컨텍스트 정보 추출 및 정제\n2. 컨텍스트 일관성 및 무결성 확인\n3. 다음 단계를 위한 컨텍스트 준비\n4. 불필요한 정보 필터링\n5. 컨텍스트 생명주기 관리\n\n**응답 형식:**\n```json\n{\n  \"context_extraction\": {\n    \"business_context\": {\n      \"domain_knowledge\": \"도메인 전문 지식\",\n      \"industry_standards\": \"업계 표준\",\n      \"organizational_constraints\": \"조직 제약사항\",\n      \"stakeholder_requirements\": \"이해관계자 요구사항\"\n    },\n    \"technical_context\": {\n      \"data_infrastructure\": \"데이터 인프라 정보\",\n      \"system_capabilities\": \"시스템 역량\",\n      \"integration_requirements\": \"통합 요구사항\",\n      \"performance_constraints\": \"성능 제약사항\"\n    },\n    \"data_context\": {\n      \"schema_information\": \"스키마 정보\",\n      \"data_quality_metrics\": \"데이터 품질 지표\",\n      \"historical_patterns\": \"과거 패턴 정보\",\n      \"business_rules\": \"비즈니스 규칙\"\n    },\n    \"analysis_context\": {\n      \"previous_analyses\": \"이전 분석 이력\",\n      \"methodology_preferences\": \"방법론 선호도\",\n      \"interpretation_guidelines\": \"해석 가이드라인\",\n      \"reporting_standards\": \"보고 표준\"\n    }\n  },\n  \"context_validation\": {\n    \"completeness_check\": \"완전성 검증 결과\",\n    \"consistency_verification\": \"일관성 검증 결과\",\n    \"relevance_assessment\": \"관련성 평가 결과\",\n    \"quality_score\": 0.0-1.0\n  },\n  \"context_preparation\": {\n    \"filtered_context\": \"필터링된 컨텍스트\",\n    \"prioritized_information\": \"우선순위별 정보\",\n    \"next_step_requirements\": \"다음 단계 요구사항\",\n    \"context_metadata\": \"컨텍스트 메타데이터\"\n  },\n  \"lifecycle_management\": {\n    \"context_expiry\": \"컨텍스트 만료 시점\",\n    \"update_triggers\": \"업데이트 트리거들\",\n    \"refresh_strategies\": \"갱신 전략들\",\n    \"cleanup_procedures\": \"정리 절차들\"\n  }\n}\n```",
    "context_types": {
      "persistent": "워크플로우 전반 유지",
      "session_scoped": "세션 범위 내 유지",
      "step_specific": "특정 단계에서만 사용",
      "temporary": "임시 사용 후 삭제"
    }
  },

  "error_recovery": {
    "system_prompt": "당신은 워크플로우 실행 중 발생하는 오류를 감지하고 복구하는 전문가입니다. 다양한 오류 상황에 대한 진단과 적절한 복구 전략을 수립합니다.",
    "user_prompt_template": "🚨 **오류 감지 및 복구 전략** (workflow_node: error_recovery)\n\n**오류 상황:**\n- 오류 타입: {error_type}\n- 발생 위치: {error_location}\n- 오류 메시지: {error_message}\n- 스택 트레이스: {stack_trace}\n\n**워크플로우 상태:**\n- 현재 노드: {current_node}\n- 이전 성공 노드: {last_successful_node}\n- 실행 히스토리: {execution_history}\n- 사용된 리소스: {resource_usage}\n\n**컨텍스트 정보:**\n- 데이터 상태: {data_state}\n- 사용자 입력: {user_inputs}\n- 시스템 설정: {system_configuration}\n- 환경 변수: {environment_variables}\n\n**오류 분석 및 복구 요구사항:**\n1. 오류 원인 분석 및 분류\n2. 영향도 및 심각도 평가\n3. 복구 전략 수립\n4. 예방 조치 제안\n5. 사용자 커뮤니케이션 계획\n\n**응답 형식:**\n```json\n{\n  \"error_analysis\": {\n    \"root_cause\": \"근본 원인\",\n    \"error_category\": \"data|system|user|network|configuration\",\n    \"severity_level\": \"critical|high|medium|low\",\n    \"impact_assessment\": {\n      \"affected_components\": [\"영향받는 구성요소들\"],\n      \"data_integrity_risk\": \"low|medium|high\",\n      \"business_impact\": \"비즈니스 영향도\",\n      \"user_experience_impact\": \"사용자 경험 영향도\"\n    }\n  },\n  \"recovery_strategy\": {\n    \"immediate_actions\": [\n      {\n        \"action\": \"즉시 취할 조치\",\n        \"priority\": \"high|medium|low\",\n        \"estimated_time\": \"예상 소요 시간\",\n        \"resource_requirement\": \"필요 리소스\"\n      }\n    ],\n    \"recovery_options\": [\n      {\n        \"option\": \"복구 옵션\",\n        \"success_probability\": 0.0-1.0,\n        \"side_effects\": [\"부작용들\"],\n        \"rollback_possibility\": true/false\n      }\n    ],\n    \"recommended_approach\": \"권장 접근법\",\n    \"fallback_plan\": \"대안 계획\"\n  },\n  \"prevention_measures\": {\n    \"validation_improvements\": [\"검증 개선사항들\"],\n    \"monitoring_enhancements\": [\"모니터링 강화 방안들\"],\n    \"configuration_updates\": [\"설정 업데이트들\"],\n    \"documentation_updates\": [\"문서화 업데이트들\"]\n  },\n  \"communication_plan\": {\n    \"user_notification\": {\n      \"message\": \"사용자 알림 메시지\",\n      \"severity_indication\": \"심각도 표시\",\n      \"expected_resolution_time\": \"예상 해결 시간\",\n      \"alternative_actions\": [\"대안 행동들\"]\n    },\n    \"stakeholder_updates\": [\"이해관계자 업데이트들\"],\n    \"progress_reporting\": \"진행 상황 보고 방식\"\n  }\n}\n```",
    "error_categories": {
      "data_errors": "데이터 관련 오류",
      "system_errors": "시스템 관련 오류",
      "user_errors": "사용자 입력 오류",
      "network_errors": "네트워크 관련 오류",
      "configuration_errors": "설정 관련 오류"
    }
  },

  "quality_assurance": {
    "system_prompt": "당신은 워크플로우 전 과정의 품질을 보장하는 전문가입니다. 데이터 품질, 분석 품질, 결과 품질을 종합적으로 평가하고 개선 방안을 제시합니다.",
    "user_prompt_template": "✅ **품질 보증 및 평가** (workflow_node: quality_assurance)\n\n**품질 평가 대상:**\n- 데이터 품질: {data_quality_metrics}\n- 분석 프로세스 품질: {process_quality_metrics}\n- 결과 품질: {result_quality_metrics}\n- 사용자 만족도: {user_satisfaction_metrics}\n\n**품질 기준:**\n- 정확성 요구사항: {accuracy_requirements}\n- 완전성 요구사항: {completeness_requirements}\n- 일관성 요구사항: {consistency_requirements}\n- 적시성 요구사항: {timeliness_requirements}\n\n**워크플로우 실행 결과:**\n- 각 단계별 결과: {step_results}\n- 성능 지표: {performance_metrics}\n- 오류 발생 이력: {error_history}\n- 사용자 피드백: {user_feedback}\n\n**품질 보증 요구사항:**\n1. 종합 품질 평가\n2. 품질 기준 준수 검증\n3. 개선 필요 영역 식별\n4. 품질 향상 계획 수립\n5. 지속적 개선 방안 제시\n\n**응답 형식:**\n```json\n{\n  \"quality_assessment\": {\n    \"overall_quality_score\": 0.0-1.0,\n    \"dimension_scores\": {\n      \"data_quality\": 0.0-1.0,\n      \"process_quality\": 0.0-1.0,\n      \"result_quality\": 0.0-1.0,\n      \"user_experience\": 0.0-1.0\n    },\n    \"quality_indicators\": {\n      \"accuracy_level\": \"정확성 수준\",\n      \"completeness_level\": \"완전성 수준\",\n      \"consistency_level\": \"일관성 수준\",\n      \"reliability_level\": \"신뢰성 수준\"\n    }\n  },\n  \"compliance_verification\": {\n    \"standards_met\": [\"충족된 표준들\"],\n    \"standards_violated\": [\"위반된 표준들\"],\n    \"compliance_score\": 0.0-1.0,\n    \"corrective_actions_needed\": [\"필요한 교정 조치들\"]\n  },\n  \"improvement_areas\": {\n    \"critical_issues\": [\n      {\n        \"issue\": \"핵심 문제\",\n        \"impact\": \"영향도\",\n        \"urgency\": \"긴급도\",\n        \"recommended_action\": \"권장 조치\"\n      }\n    ],\n    \"optimization_opportunities\": [\n      {\n        \"area\": \"최적화 영역\",\n        \"potential_benefit\": \"잠재적 이익\",\n        \"implementation_effort\": \"구현 노력\",\n        \"priority\": \"우선순위\"\n      }\n    ]\n  },\n  \"quality_improvement_plan\": {\n    \"short_term_actions\": [\"단기 개선 조치들\"],\n    \"medium_term_actions\": [\"중기 개선 조치들\"],\n    \"long_term_actions\": [\"장기 개선 조치들\"],\n    \"success_metrics\": [\"성공 지표들\"],\n    \"monitoring_strategy\": \"모니터링 전략\"\n  },\n  \"continuous_improvement\": {\n    \"feedback_mechanisms\": [\"피드백 메커니즘들\"],\n    \"learning_opportunities\": [\"학습 기회들\"],\n    \"best_practices\": [\"모범 사례들\"],\n    \"knowledge_sharing\": \"지식 공유 방안\"\n  }\n}\n```",
    "quality_dimensions": {
      "accuracy": "정확성",
      "completeness": "완전성", 
      "consistency": "일관성",
      "timeliness": "적시성",
      "reliability": "신뢰성",
      "usability": "사용성"
    }
  }
} 