{
  "nodes": {
    "start": {
      "description": "시스템 시작 및 초기화",
      "transitions": [
        {
          "condition": "시스템 준비 완료",
          "next": "data_selection"
        }
      ]
    },
    "data_selection": {
      "description": "데이터 파일 선택",
      "subtasks": [
        {
          "id": "data_selection_1",
          "description": "input_data/data_files/ 폴더에서 사용 가능한 데이터 파일 목록 표시"
        },
        {
          "id": "data_selection_2", 
          "description": "사용자가 분석할 데이터 파일 선택"
        },
        {
          "id": "data_selection_3",
          "description": "선택된 데이터 파일 로딩 및 기본 정보 확인"
        }
      ],
      "transitions": [
        {
          "condition": "데이터 선택 및 로딩 완료",
          "next": "data_overview"
        },
        {
          "condition": "로딩 실패",
          "next": "error_handling"
        }
      ]
    },
    "data_overview": {
      "description": "데이터 개요 확인 및 기본 검증",
      "subtasks": [
        {
          "id": "data_overview_1",
          "description": "데이터 형태 확인 (행/열 수, 컬럼명, 데이터 타입)"
        },
        {
          "id": "data_overview_2",
          "description": "기본적인 데이터 품질 검증 (과도한 결측치, 명백한 오류 등)"
        },
        {
          "id": "data_overview_3",
          "description": "데이터 로딩 완료 상태 사용자에게 알림"
        }
      ],
      "transitions": [
        {
          "condition": "데이터 검증 통과",
          "next": "natural_language_request"
        },
        {
          "condition": "심각한 데이터 품질 문제",
          "next": "error_handling"
        }
      ]
    },
    "natural_language_request": {
      "description": "자연어 분석 요청 입력",
      "subtasks": [
        {
          "id": "nlr_1",
          "description": "사용자에게 자연어로 분석 요구사항 입력 요청"
        },
        {
          "id": "nlr_2",
          "description": "입력된 자연어 요청 기본 파싱 및 유효성 검증"
        },
        {
          "id": "nlr_3",
          "description": "분석 요청과 데이터 컬럼의 기본적 매칭 가능성 확인"
        }
      ],
      "transitions": [
        {
          "condition": "유효한 자연어 요청 입력 완료",
          "next": "rag_system_activation"
        },
        {
          "condition": "요청이 불명확하거나 데이터와 불일치",
          "next": "request_clarification"
        }
      ]
    },
    "request_clarification": {
      "description": "요청 명확화",
      "subtasks": [
        {
          "id": "clarification_1",
          "description": "LLM이 불명확한 부분에 대해 구체적 질문 생성"
        },
        {
          "id": "clarification_2",
          "description": "사용자 응답 수집 및 요청 업데이트"
        }
      ],
      "transitions": [
        {
          "condition": "요청 명확화 완료",
          "next": "rag_system_activation"
        },
        {
          "condition": "여전히 불명확",
          "next": "natural_language_request"
        }
      ]
    },
    "rag_system_activation": {
      "description": "RAG 시스템 활성화 및 컨텍스트 검색",
      "subtasks": [
        {
          "id": "rag_activation_1",
          "description": "자연어 요청을 기반으로 RAG 검색 쿼리 생성"
        },
        {
          "id": "rag_activation_2",
          "description": "비즈니스 지식 검색과 DB 스키마 검색 병렬 실행"
        }
      ],
      "transitions": [
        {
          "condition": "RAG 검색 준비 완료",
          "next": "business_knowledge_search"
        }
      ]
    },
    "business_knowledge_search": {
      "description": "비즈니스 도메인 지식 검색",
      "subtasks": [
        {
          "id": "business_search_1",
          "description": "business_dictionary.json에서 관련 용어 검색"
        },
        {
          "id": "business_search_2",
          "description": "domain_knowledge.md에서 도메인 전문 지식 검색"
        },
        {
          "id": "business_search_3",
          "description": "analysis_guidelines.md에서 분석 가이드라인 검색"
        },
        {
          "id": "business_search_4",
          "description": "검색된 비즈니스 컨텍스트 정보 통합"
        }
      ],
      "transitions": [
        {
          "condition": "비즈니스 지식 검색 완료",
          "next": "schema_structure_search"
        }
      ]
    },
    "schema_structure_search": {
      "description": "데이터베이스 스키마 구조 검색",
      "subtasks": [
        {
          "id": "schema_search_1",
          "description": "데이터 컬럼과 매칭되는 schema_definitions.json 정보 검색"
        },
        {
          "id": "schema_search_2",
          "description": "relationship_maps.json에서 테이블 관계 정보 검색"
        },
        {
          "id": "schema_search_3",
          "description": "column_descriptions.json에서 상세 컬럼 설명 검색"
        },
        {
          "id": "schema_search_4",
          "description": "검색된 스키마 정보와 현재 데이터 구조 매핑"
        }
      ],
      "transitions": [
        {
          "condition": "스키마 구조 검색 완료",
          "next": "ai_recommendation_generation"
        }
      ]
    },
    "ai_recommendation_generation": {
      "description": "AI 기반 분석 방법 추천 생성",
      "subtasks": [
        {
          "id": "ai_rec_1",
          "description": "자연어 요청, 데이터 특성, 비즈니스 컨텍스트, 스키마 정보 종합 분석"
        },
        {
          "id": "ai_rec_2",
          "description": "적합한 통계 방법 1-3개 선별 및 추천도 계산"
        },
        {
          "id": "ai_rec_3",
          "description": "각 추천 방법에 대한 상세 설명 및 적용 이유 생성"
        },
        {
          "id": "ai_rec_4",
          "description": "스키마 제약조건 및 비즈니스 규칙 고려사항 포함"
        }
      ],
      "transitions": [
        {
          "condition": "AI 추천 생성 완료",
          "next": "recommendation_display"
        },
        {
          "condition": "추천 생성 실패",
          "next": "error_handling"
        }
      ]
    },
    "recommendation_display": {
      "description": "추천 방법 사용자에게 표시 및 선택",
      "subtasks": [
        {
          "id": "rec_display_1",
          "description": "추천된 통계 방법들을 순위별로 표시"
        },
        {
          "id": "rec_display_2",
          "description": "각 방법의 적용 이유, 전제조건, 비즈니스 해석 설명"
        },
        {
          "id": "rec_display_3",
          "description": "사용자의 방법 선택 대기"
        }
      ],
      "transitions": [
        {
          "condition": "사용자가 추천 방법 선택",
          "next": "method_confirmation"
        },
        {
          "condition": "사용자가 추가 설명 요청",
          "next": "recommendation_explanation"
        }
      ]
    },
    "recommendation_explanation": {
      "description": "추천 방법 상세 설명",
      "subtasks": [
        {
          "id": "rec_exp_1",
          "description": "선택된 방법의 상세 원리 및 적용 조건 설명"
        },
        {
          "id": "rec_exp_2",
          "description": "현재 데이터에서의 적용 가능성 및 예상 결과 설명"
        }
      ],
      "transitions": [
        {
          "condition": "설명 완료",
          "next": "recommendation_display"
        }
      ]
    },
    "method_confirmation": {
      "description": "선택된 분석 방법 확정",
      "subtasks": [
        {
          "id": "method_conf_1",
          "description": "사용자가 선택한 통계 방법 확정"
        },
        {
          "id": "method_conf_2",
          "description": "선택된 방법에 필요한 전제조건 목록 생성"
        },
        {
          "id": "method_conf_3",
          "description": "자동 분석 프로세스 준비"
        }
      ],
      "transitions": [
        {
          "condition": "방법 확정 완료",
          "next": "automated_preprocessing"
        }
      ]
    },
    "automated_preprocessing": {
      "description": "자동 데이터 전처리",
      "subtasks": [
        {
          "id": "auto_prep_1",
          "description": "선택된 분석 방법에 필요한 변수 자동 식별"
        },
        {
          "id": "auto_prep_2",
          "description": "데이터 타입 자동 변환 (필요시)"
        },
        {
          "id": "auto_prep_3",
          "description": "기본적인 결측치 처리 (임계값 기준 자동 처리)"
        },
        {
          "id": "auto_prep_4",
          "description": "명백한 이상치 자동 식별 및 처리"
        }
      ],
      "transitions": [
        {
          "condition": "전처리 완료",
          "next": "automated_assumption_testing"
        },
        {
          "condition": "심각한 데이터 문제 발견",
          "next": "data_quality_issues"
        }
      ]
    },
    "automated_assumption_testing": {
      "description": "통계적 가정 자동 검정",
      "subtasks": [
        {
          "id": "assumption_1",
          "description": "정규성 검정 자동 수행 (Shapiro-Wilk, Kolmogorov-Smirnov)"
        },
        {
          "id": "assumption_2",
          "description": "등분산성 검정 자동 수행 (Levene's test, Bartlett's test)"
        },
        {
          "id": "assumption_3",
          "description": "독립성 검정 자동 수행 (필요시)"
        },
        {
          "id": "assumption_4",
          "description": "표본 크기 적절성 자동 확인"
        },
        {
          "id": "assumption_5",
          "description": "가정 위반 시 자동 대안 방법 선택 (예: 비모수 검정)"
        }
      ],
      "transitions": [
        {
          "condition": "모든 가정 충족 또는 적절한 대안 선택",
          "next": "statistical_analysis_execution"
        },
        {
          "condition": "해결 불가능한 가정 위반",
          "next": "assumption_violation_handling"
        }
      ]
    },
    "assumption_violation_handling": {
      "description": "가정 위반 처리",
      "subtasks": [
        {
          "id": "violation_1",
          "description": "위반된 가정과 그 영향 분석"
        },
        {
          "id": "violation_2",
          "description": "자동 대안 방법 제시 (비모수 검정, 로버스트 방법 등)"
        },
        {
          "id": "violation_3",
          "description": "데이터 변환 옵션 제시 (로그 변환, 제곱근 변환 등)"
        }
      ],
      "transitions": [
        {
          "condition": "대안 방법 적용 가능",
          "next": "statistical_analysis_execution"
        },
        {
          "condition": "분석 불가능",
          "next": "analysis_impossible"
        }
      ]
    },
    "statistical_analysis_execution": {
      "description": "통계 분석 자동 실행",
      "subtasks": [
        {
          "id": "analysis_exec_1",
          "description": "확정된 통계 방법으로 분석 코드 자동 생성"
        },
        {
          "id": "analysis_exec_2",
          "description": "통계 분석 실행 및 결과 수집"
        },
        {
          "id": "analysis_exec_3",
          "description": "효과 크기, 신뢰구간, p-value 등 핵심 지표 추출"
        },
        {
          "id": "analysis_exec_4",
          "description": "사후 검정 자동 수행 (필요시)"
        }
      ],
      "transitions": [
        {
          "condition": "분석 실행 성공",
          "next": "results_interpretation"
        },
        {
          "condition": "분석 실행 오류",
          "next": "execution_error_handling"
        }
      ]
    },
    "results_interpretation": {
      "description": "결과 해석 및 비즈니스 인사이트 생성",
      "subtasks": [
        {
          "id": "interpretation_1",
          "description": "통계 결과의 수치적 해석 (유의성, 효과 크기 등)"
        },
        {
          "id": "interpretation_2",
          "description": "비즈니스 컨텍스트를 고려한 실무적 해석"
        },
        {
          "id": "interpretation_3",
          "description": "DB 스키마 정보를 활용한 데이터 구조적 해석"
        },
        {
          "id": "interpretation_4",
          "description": "분석 결과의 한계점 및 주의사항 제시"
        }
      ],
      "transitions": [
        {
          "condition": "해석 완료",
          "next": "report_generation"
        }
      ]
    },
    "report_generation": {
      "description": "결과 보고서 생성",
      "subtasks": [
        {
          "id": "report_1",
          "description": "분석 목적 및 사용된 방법 요약"
        },
        {
          "id": "report_2",
          "description": "데이터 개요 및 전처리 과정 설명"
        },
        {
          "id": "report_3",
          "description": "통계 분석 결과 및 해석"
        },
        {
          "id": "report_4",
          "description": "비즈니스 인사이트 및 권장사항"
        },
        {
          "id": "report_5",
          "description": "시각화 차트 및 표 생성"
        },
        {
          "id": "report_6",
          "description": "HTML/PDF 보고서 파일 생성"
        }
      ],
      "transitions": [
        {
          "condition": "보고서 생성 완료",
          "next": "session_continuation"
        }
      ]
    },
    "session_continuation": {
      "description": "세션 지속 또는 종료",
      "subtasks": [
        {
          "id": "continuation_1",
          "description": "분석 결과 사용자에게 제시"
        },
        {
          "id": "continuation_2",
          "description": "추가 분석 요청 여부 확인"
        },
        {
          "id": "continuation_3",
          "description": "세션 컨텍스트 저장"
        }
      ],
      "transitions": [
        {
          "condition": "사용자가 추가 분석 요청",
          "next": "natural_language_request"
        },
        {
          "condition": "사용자가 다른 데이터로 분석 요청",
          "next": "data_selection"
        },
        {
          "condition": "사용자가 세션 종료 요청",
          "next": "session_end"
        }
      ]
    },
    "data_quality_issues": {
      "description": "데이터 품질 문제 처리",
      "subtasks": [
        {
          "id": "quality_1",
          "description": "발견된 데이터 품질 문제 상세 분석"
        },
        {
          "id": "quality_2",
          "description": "자동 해결 가능한 문제 처리"
        },
        {
          "id": "quality_3",
          "description": "수동 개입 필요한 문제 사용자에게 알림"
        }
      ],
      "transitions": [
        {
          "condition": "문제 해결됨",
          "next": "automated_assumption_testing"
        },
        {
          "condition": "해결 불가능",
          "next": "analysis_impossible"
        }
      ]
    },
    "execution_error_handling": {
      "description": "실행 오류 처리",
      "subtasks": [
        {
          "id": "error_1",
          "description": "오류 원인 분석 및 분류"
        },
        {
          "id": "error_2",
          "description": "자동 복구 시도 (대안 방법, 매개변수 조정 등)"
        },
        {
          "id": "error_3",
          "description": "복구 불가능 시 사용자에게 상황 설명"
        }
      ],
      "transitions": [
        {
          "condition": "오류 해결됨",
          "next": "statistical_analysis_execution"
        },
        {
          "condition": "해결 불가능",
          "next": "analysis_impossible"
        }
      ]
    },
    "analysis_impossible": {
      "description": "분석 불가능 상황 처리",
      "subtasks": [
        {
          "id": "impossible_1",
          "description": "분석 불가능 이유 상세 설명"
        },
        {
          "id": "impossible_2",
          "description": "데이터 개선 방안 제시"
        },
        {
          "id": "impossible_3",
          "description": "대안 분석 방법 제안 (가능한 경우)"
        },
        {
          "id": "impossible_4",
          "description": "전문가 상담 권장"
        }
      ],
      "transitions": [
        {
          "condition": "사용자가 다른 분석 시도",
          "next": "natural_language_request"
        },
        {
          "condition": "사용자가 다른 데이터 선택",
          "next": "data_selection"
        },
        {
          "condition": "세션 종료",
          "next": "session_end"
        }
      ]
    },
    "error_handling": {
      "description": "일반적인 오류 처리",
      "subtasks": [
        {
          "id": "error_general_1",
          "description": "오류 유형 판단 및 적절한 처리 방법 선택"
        },
        {
          "id": "error_general_2",
          "description": "사용자에게 오류 상황 설명 및 대안 제시"
        }
      ],
      "transitions": [
        {
          "condition": "복구 가능한 오류",
          "next": "data_selection"
        },
        {
          "condition": "시스템 오류",
          "next": "session_end"
        }
      ]
    },
    "session_end": {
      "description": "세션 종료",
      "subtasks": [
        {
          "id": "end_1",
          "description": "세션 결과 요약"
        },
        {
          "id": "end_2",
          "description": "생성된 파일들 정리 및 저장"
        },
        {
          "id": "end_3",
          "description": "시스템 리소스 정리"
        },
        {
          "id": "end_4",
          "description": "사용자에게 세션 종료 알림"
        }
      ]
    }
  },
  "workflow_metadata": {
    "version": "2.0.0",
    "description": "Enhanced Multi-turn Conversational Statistical Analysis with RAG System",
    "key_features": [
      "자연어 기반 분석 요청",
      "비즈니스 지식 + DB 스키마 RAG 검색",
      "AI 기반 통계 방법 추천",
      "자동화된 가정 검정",
      "다중턴 대화형 워크플로우"
    ],
    "automation_level": "high",
    "user_intervention_points": [
      "데이터 파일 선택",
      "자연어 분석 요청 입력", 
      "AI 추천 방법 선택",
      "추가 분석 요청 결정"
    ]
  }
}